<!-- admin.xhtml -->
<ui:composition template="temp.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core"
                xmlns:pcs="http://java.sun.com/jsf/composite/pcs">
    <ui:define name="title">My Requisitions</ui:define>
    <ui:define name="main-content">
        <p:tabView>
            <p:tab title="Current">
                <h2 class="mb">Create Requisition</h2>
                <h:form id="requisition_form" styleClass="pad2 mb flex column">
                    <p:panelGrid columns="2" layout="tabular">
                        <h:panelGroup class="flex column">
                            <p:outputLabel for="budgetline" value="Budget Line"/>
                            <p:selectOneMenu id="budgetline" placeholder="Budgetline" value="#{createRequisition.budgetLineId}">
                                <p:ajax event="change" update="requisition_form" listener="#{createRequisition.updateBudgetLine()}"/>
                                <f:selectItem value="#{null}" itemLabel="Select One" itemDisabled="true"/>
                                <f:selectItems value="#{createRequisition.budgetLines}" var="budgetline" itemValue="#{budgetline.id}" itemLabel="#{budgetline.description}"/>
                            </p:selectOneMenu>
                        </h:panelGroup>
                        <h:panelGroup class="flex column">
                            <p:outputLabel for="amount" value="Amount"/>
                            <p:inputNumber id="amount" disabled="#{createRequisition.budgetLine == null}" maxValue="#{createRequisition.budgetLine.balance}" placeholder="Amount" value="#{createRequisition.requestedAmount}"/>
                        </h:panelGroup>
                        <h:panelGroup class="flex column">
                            <p:outputLabel for="status" value="Status"/>
                            <p:inputText id="status" placeholder="Status" readonly="true" value="DRAFT"/>
                        </h:panelGroup>
                        <h:panelGroup class="flex column">
                            <p:outputLabel for="date_needed" value="Date Needed"/>
                            <p:calendar id="date_needed" mindate="c" placeholder="Date Needed" value="#{createRequisition.maxDate}"/>
                        </h:panelGroup>
                        <h:panelGroup class="flex column">
                            <p:outputLabel for="justification" value="Justification"/>
                            <p:inputTextarea id="justification" placeholder="Description..." value="#{createRequisition.justification}"/>
                        </h:panelGroup>
                    </p:panelGrid>
                    <div><p:commandButton value="Submit" icon="pi pi-check" styleClass="mt pill"
                                          actionListener="#{createRequisition.createRequisition}"
                                          onclick="PF('new_requisition_dialog').hide()" update="requisition_form"/></div>
                </h:form>
                <h:panelGroup rendered="true" styleClass="mt pad2">
                    <h3 class="mb">Accountability</h3>
                    <h:form styleClass="flex column">
                        <p:outputLabel for="ac_description" value="Description" styleClass="mt"/>
                        <p:inputTextarea id="ac_description" placeholder="Description" styleClass="mb" value="For Tee Pee"/>
                        <div>
                            <p:commandButton value="Add Image" icon="pi pi-plus" styleClass="mt pill"/>
                        </div>
                        <p:panelGrid columns="3" id="images" styleClass="pad1">
                            <pcs:image id="image" image="https://imgs.search.brave.com/o3iyKswXLfPlG8mqK7Tn0p1bi4duwqxMoquE_PkfG_I/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly9tZWRp/YS5pc3RvY2twaG90/by5jb20vaWQvNDgz/MzcxNjM3L3Bob3Rv/L3JlY2VpcHQuanBn/P3M9NjEyeDYxMiZ3/PTAmaz0yMCZjPXRP/RXUwR3FnR0pCV2Jx/QVpVb09iblNXSFZK/clRDNEtfN0NiZXVu/ZkRxQnM9"/>
                        </p:panelGrid>
                        <div>
                            <p:commandButton value="Submit Accountability" icon="pi pi-upload" styleClass="mt pill"/>
                        </div>

                    </h:form>
                </h:panelGroup>
            </p:tab>
            <p:tab title="History">
                <p:dataTable paginator="true" rows="5" rowsPerPageTemplate="5,10,15" value="#{loginBean.loggedInUser.requisition}" var="requisition">
                    <p:column headerText="No." width="12px">
                        #{loginBean.loggedInUser.requisition.indexOf(requisition) + 1}
                    </p:column>
                    <p:column headerText="Description">
                        #{requisition.justification}
                    </p:column>
                    <p:column headerText="Status">
                        #{requisition.status}
                    </p:column>
                    <p:column headerText="Requested">
                        #{requisition.estimatedAmount}
                    </p:column>
                    <p:column headerText="Granted">
                        #{requisition.amountGranted}
                    </p:column>
                    <p:column headerText="Budget Line">
                        #{requisition.budgetline.description}
                    </p:column>
                    <p:column headerText="Date Approved">
                        #{requisition.dateApproved}
                    </p:column>
                </p:dataTable>
            </p:tab>
        </p:tabView>

    </ui:define>
</ui:composition>